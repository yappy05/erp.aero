# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∞—É–¥–∏–æ —Å Whisper Large –≤ Google Colab

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Google Colab
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://colab.research.google.com/
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π Google –∞–∫–∫–∞—É–Ω—Ç
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π notebook: **–§–∞–π–ª ‚Üí –ù–æ–≤—ã–π –±–ª–æ–∫–Ω–æ—Ç**

### –®–∞–≥ 2: –í–∫–ª—é—á–∏—Ç–µ GPU (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –í –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ: **–°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ‚Üí –ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø —Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**
2. –í —Ä–∞–∑–¥–µ–ª–µ **–£—Å–∫–æ—Ä–∏—Ç–µ–ª—å –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è** –≤—ã–±–µ—Ä–∏—Ç–µ **T4 GPU** –∏–ª–∏ **A100 GPU**
3. –ù–∞–∂–º–∏—Ç–µ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å**

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é —è—á–µ–π–∫—É –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```python
!pip install openai-whisper
!pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
!pip install ffmpeg-python
```

### –®–∞–≥ 4: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª—å Whisper Large
–°–æ–∑–¥–∞–π—Ç–µ –≤—Ç–æ—Ä—É—é —è—á–µ–π–∫—É:
```python
import whisper
import torch

device = "cuda" if torch.cuda.is_available() else "cpu"
print(f"–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: {device}")

model = whisper.load_model("large", device=device)
print("‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞!")
```

### –®–∞–≥ 5: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª

#### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Colab (–ø—Ä–æ—â–µ –≤—Å–µ–≥–æ)
```python
from google.colab import files

# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
uploaded = files.upload()

# –ü–æ–ª—É—á–∏—Ç—å –∏–º—è —Ñ–∞–π–ª–∞
audio_file = list(uploaded.keys())[0]
print(f"‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: {audio_file}")
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –í—ã–ø–æ–ª–Ω–∏—Ç–µ —è—á–µ–π–∫—É —Å —ç—Ç–∏–º –∫–æ–¥–æ–º
- –ü–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã"
- –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ—ë –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –∞—É–¥–∏–æ —Ñ–∞–π–ª
- –§–∞–π–ª –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é Colab

#### –°–ø–æ—Å–æ–± 2: –ò–∑ Google Drive
```python
from google.colab import drive

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å Google Drive
drive.mount('/content/drive')

# –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ –≤–∞—à–µ–º Drive
audio_file = "/content/drive/MyDrive/path/to/your/audio.mp3"
```

#### –°–ø–æ—Å–æ–± 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ URL
```python
import urllib.request

# –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –ø–æ —Å—Å—ã–ª–∫–µ
url = "https://example.com/audio.mp3"
audio_file = "downloaded_audio.mp3"
urllib.request.urlretrieve(url, audio_file)
print(f"‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: {audio_file}")
```

### –®–∞–≥ 6: –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—é
```python
print(f"üé§ –ù–∞—á–∏–Ω–∞–µ–º —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—é: {audio_file}")

result = model.transcribe(
    audio_file,
    language="ru",  # "ru" - —Ä—É—Å—Å–∫–∏–π, "en" - –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, None - –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    task="transcribe",  # "transcribe" –∏–ª–∏ "translate"
    verbose=True,
)

print("\nüìù –¢–µ–∫—Å—Ç:")
print(result["text"])
```

### –®–∞–≥ 7: –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```python
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª
output_file = audio_file.rsplit('.', 1)[0] + "_transcription.txt"
with open(output_file, "w", encoding="utf-8") as f:
    f.write(result["text"])

# –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
files.download(output_file)
```

## üéØ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∞—É–¥–∏–æ
- MP3
- WAV
- M4A
- FLAC
- OGG
- –∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ ffmpeg

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è–∑—ã–∫–∞
```python
# –î–ª—è —Ä—É—Å—Å–∫–æ–≥–æ
result = model.transcribe(audio_file, language="ru")

# –î–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ
result = model.transcribe(audio_file, language="en")

# –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞
result = model.transcribe(audio_file, language=None)
```

### –ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
```python
result = model.transcribe(
    audio_file,
    language="ru",
    task="translate"  # –ü–µ—Ä–µ–≤–µ–¥–µ—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
)
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
```python
result = model.transcribe(audio_file, language="ru")

for segment in result["segments"]:
    start = segment['start']  # –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    end = segment['end']      # –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    text = segment['text']
    print(f"[{start:.1f}s - {end:.1f}s] {text}")
```

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

1. **GPU vs CPU**: GPU –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É. –î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (–±–æ–ª–µ–µ 10 –º–∏–Ω—É—Ç) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU.

2. **–†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏**: –ú–æ–¥–µ–ª—å "large" —Å–∞–º–∞—è —Ç–æ—á–Ω–∞—è, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–∞—è. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ "medium" –∏–ª–∏ "base":
   ```python
   model = whisper.load_model("medium", device=device)
   ```

3. **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–∞**: Whisper –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ª—é–±–æ–π –¥–ª–∏–Ω—ã, –Ω–æ –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (>30 –º–∏–Ω—É—Ç) –º–æ–≥—É—Ç –∑–∞–Ω—è—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

4. **–û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏**: –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –º–æ–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø–∞–º—è—Ç—å:
   ```python
   del model
   torch.cuda.empty_cache()
   ```

## ‚ùì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: "CUDA out of memory"
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à—É—é –º–æ–¥–µ–ª—å –∏–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ —Ñ–∞–π–ª —á–∞—Å—Ç—è–º–∏.

**–ü—Ä–æ–±–ª–µ–º–∞**: –§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º –æ–∫–æ–ª–æ 2GB –¥–ª—è Colab) –∏ —Ñ–æ—Ä–º–∞—Ç.

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GPU –≤–∫–ª—é—á–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

## üìù –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –∫–æ–¥–∞

–°–º. —Ñ–∞–π–ª `whisper_colab.py` - —Ç–∞–º –µ—Å—Ç—å –ø–æ–ª–Ω—ã–π –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ Colab.


